<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    Hadoop之倒排索引 |  面朝大海，春暖花开
  </title>
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/css/style.css">
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">
  
<script src="/js/pace.min.js"></script>


  

  

<meta name="generator" content="Hexo 4.1.1"></head>

</html>

<body>
  <div id="app">
    <main class="content">
      <section class="outer">
  <article id="post-Hadoop之倒排索引" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Hadoop之倒排索引
</h1>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2019/12/25/Hadoop%E4%B9%8B%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95/" class="article-date">
  <time datetime="2019-12-25T12:25:02.000Z" itemprop="datePublished">2019-12-25</time>
</a>
      
    </div>
    

    
    
    <div class="tocbot"></div>





    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>输入N个文件，生成带详细信息的倒排索引。其中，输入为莎士比亚文集<a href="http://course.ucas.ac.cn/access/content/group/49762-2/Shakespeare.tar.gz" target="_blank" rel="noopener">Shakespeare.tar.gz</a>。<br>举例如下，有4个输入文件：</p>
<ul>
<li>d1.txt: cat dog cat fox</li>
<li>d2.txt: cat bear cat cat fox</li>
<li>d3.txt: fox wolf dog</li>
<li>d4.txt: wolf hen rabbit cat sheep<br>要求建立如下格式的倒排索引：</li>
<li>cat —&gt;3: {(d1.txt,2,4),(d2.txt,3,5),(d4.txt,1,5)}</li>
<li>单词—&gt;出现该单词的文件个数: {(出现该单词的文件名（或文件id)，单词在该文件中的出现次数，该文件 的总单词数),……}</li>
</ul>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul>
<li><p>硬件环境：Intel(R) Core(TM)i5-8250U <a href="mailto:CPU@1.6GHz">CPU@1.6GHz</a> 1.8GHz / 8GB内存</p>
</li>
<li><p>软件环境：Ubuntu18.04 64-bit  Java 13.0.1 Hadoop 2.7.4</p>
<h2 id="倒排索引"><a href="#倒排索引" class="headerlink" title="倒排索引"></a>倒排索引</h2><p>倒排索引是文档检索系统中最常用的数据结构，被广泛用于全文搜索引擎。它主要是用来存储某个单词（或词组）在一个文档或一组文档的存储位置的映射，即提供了一种根据内容来查找文档的方式。由于不是根据文档来确定文档所包含的内容，而是进行了相反的操作（根据关键字来查找文档），因而称为倒排索引（Inverted Index）。通常情况下，倒排索引由一个单词（词组）以及相关的文档列表（标示文档的ID号，或者是指定文档所在位置的URI）组成，如下图所示：<br><img src="https://img-blog.csdnimg.cn/20191225192348832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2diaDE4NjgyMDMwODYy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>从上图可以看出，单词1出现在{文档1、文档4、文档13、……}中，单词2出现在{文档3、文档5、文档15、…..}中，而单词3出现在{文档1、文档8、文档20、….}中，还需要给每个文档添加一个权值，用来指出每个文档与搜素内容相关的相关度，如下图所示：<br><img src="https://img-blog.csdnimg.cn/20191225192511863.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2diaDE4NjgyMDMwODYy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最常用的是使用词频作为权重，即记录单词在文档中出现的次数了。以英文为例，如下图所示，索引文件中的“MapReduce”一行表示：“MapReduce”这个单词在文本T0中出现过1次，T1中出现过1次，T2中出现过2次。当搜索条件为“MapReduce”、“is”、“simple”时，对应的集合为：{T0，T1，T2}∩{ T0，T1}∩{ T0，T1}={ T0，T1}，即文本T0和T1包含所要索引的单词，而且只有T0是连续的。<br><img src="https://img-blog.csdnimg.cn/20191225192837964.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2diaDE4NjgyMDMwODYy,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="总体思路"><a href="#总体思路" class="headerlink" title="总体思路"></a>总体思路</h2><p>通过两个 Map/Reduce 过程就可以到达要求。 第一个Map/Reduce 统计各个文件中的所有单词的出现次数，以及各个文件单词总数；第二个 Map/Reduce 根据第一个 Map/Reduce 的统计结果处理加工得到单词倒排索引。</p>
</li>
<li><p>第一个 map/reduce 详细设计<br>在 map 过程中，重写 map 类， 利用 StringTokenizer 类，将 map 方法中的<br>value 值中存储的文本，拆分成一个个的单词， 并获取文件名， 以两种格式进<br>行输出&lt;filename+word,1&gt;或者&lt;filename,1&gt;</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> IOException, InterruptedException </span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">//获取文件名</span></span><br><span class="line">            FileSplit fileSplit= (FileSplit)context.getInputSplit();</span><br><span class="line">            String fileName = fileSplit.getPath().getName();</span><br><span class="line">    </span><br><span class="line">            <span class="comment">//获取单词在单个文件中出现次数，及文件单词总数</span></span><br><span class="line">            StringTokenizer itr= <span class="keyword">new</span> StringTokenizer(value.toString());</span><br><span class="line">            <span class="keyword">for</span>(; itr.hasMoreTokens(); ) </span><br><span class="line">            &#123;</span><br><span class="line">                String word =removeNonLetters( itr.nextToken().toLowerCase());</span><br><span class="line">                String fileWord = fileName+<span class="string">"\001"</span>+word;</span><br><span class="line">                <span class="keyword">if</span>(!word.equals(<span class="string">""</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    context.write(<span class="keyword">new</span> Text(fileWord), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">                    context.write(<span class="keyword">new</span> Text(fileName), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>在Reduce过程中，统计得到每个文件中每个单词的出现次数，以及每个文件的单词总数，输出&lt;key,count&gt;。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (IntWritable val : values)</span><br><span class="line">    &#123;</span><br><span class="line">        sum += val.get();</span><br><span class="line">    &#125;</span><br><span class="line">    context.write(key,<span class="keyword">new</span> IntWritable(sum));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>第二个 map/reduce 详细设计<br>Map过程读取第一个MR的输出，对value值进行拆分，重新组合后输出键为固定Text类型值index，值为filename+word+count或者filename+count。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    String valStr = value.toString();</span><br><span class="line">    String[] records = valStr.split(<span class="string">"\t"</span>);</span><br><span class="line">    context.write(<span class="keyword">new</span> Text(<span class="string">"index"</span>),<span class="keyword">new</span> Text(records[<span class="number">0</span>]+<span class="string">"\001"</span>+records[<span class="number">1</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Reduce过程中定义四个HashMap，Map&lt;String,Integer&gt; wordinfilescount，key为单词+文件名，value为单词在该文件中出现的次数；Map&lt;String,Integer&gt; filescount ，key为文件名，value为文件的单词总数；Map&lt;String,Integer&gt; wordinfiles， key为单词，value为单词在多少个文件中现；Map&lt;String,String&gt; indexes，key为单词，value为倒排索引。读取values值，根据设定分隔符拆分，判断拆分后长度如果为2，则该值为文件名+文件单词总数，将拆分后的文件名及文件单词总数，组成键值对放入Map&lt;String,Integer&gt; filescount；拆分后长度如果为3，则该值为文件名+单词+单词在该文件中出现次数，将拆分后的文件名+单词及单词在该文件中出现次数组成键值对放入Map&lt;String,Integer&gt; wordinfilescount，同时统计单词在多少个文件中出现，并组成键值对放入Map&lt;String,Integer&gt; wordinfiles。遍历Map&lt;String,Integer&gt; wordinfilescount，将单词作为键，“单词-&gt;出现该单词的文件个数:总文件个数：{(出现该单词的文件名，单词在该文件中的出现次数，该文件的总单词数)”作为值，放入Map&lt;String,String&gt; indexes中。遍历Map&lt;String,String&gt; indexes获取倒排索引并输出全部索引。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span>  <span class="title">InverseReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">NullWritable</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Integer&gt; wordinfilescount = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();<span class="comment">//key为单词+文件名，value为单词在该文件中出现的次数</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Integer&gt; filescount = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();<span class="comment">//key为文件名，value为文件的单词总数</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Integer&gt; wordinfiles = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();<span class="comment">//key为单词，value为单词在多少的文件中出现</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; indexes = <span class="keyword">new</span> HashMap&lt;String, String&gt;();<span class="comment">//key为单词，value为倒排索引</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;Text&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">        <span class="comment">//拆分输入，获取单词出现在几个文件中以及在该文件中出现次数，各个文件的单词总数，总文件数</span></span><br><span class="line">        <span class="keyword">for</span> (Text val : values) &#123;</span><br><span class="line">            String valStr = val.toString();</span><br><span class="line">            String[] records = valStr.split(<span class="string">"\001"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span> (records.length) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    filescount.put(records[<span class="number">0</span>], Integer.parseInt(records[<span class="number">1</span>]));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>: &#123;</span><br><span class="line">                    wordinfilescount.put(valStr, Integer.parseInt(records[<span class="number">2</span>]));</span><br><span class="line">                    <span class="keyword">if</span> (!wordinfiles.containsKey(records[<span class="number">1</span>])) &#123;</span><br><span class="line">                        wordinfiles.put(records[<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        wordinfiles.put(records[<span class="number">1</span>], wordinfiles.get(records[<span class="number">1</span>]) + <span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                ;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//处理获取倒排索引</span></span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;String, Integer&gt; entry : wordinfilescount.entrySet()) &#123;</span><br><span class="line">            String valStr = entry.getKey();</span><br><span class="line">            String[] records = valStr.split(<span class="string">"\001"</span>);</span><br><span class="line">            String word = records[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (!indexes.containsKey(word)) &#123;</span><br><span class="line">                StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                sb.append(word)</span><br><span class="line">                        .append(<span class="string">"-&gt;"</span>)</span><br><span class="line">                        .append(wordinfiles.get(word))</span><br><span class="line">                        .append(<span class="string">":"</span>)</span><br><span class="line">                        .append(<span class="string">"&#123;("</span>)</span><br><span class="line">                        .append(records[<span class="number">0</span>])</span><br><span class="line">                        .append(<span class="string">","</span>)</span><br><span class="line">                        .append(entry.getValue())</span><br><span class="line">                        .append(<span class="string">","</span>)</span><br><span class="line">                        .append(filescount.get(records[<span class="number">0</span>]))</span><br><span class="line">                        .append(<span class="string">")"</span>);</span><br><span class="line">                indexes.put(word, sb.toString());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                sb.append(<span class="string">",("</span>)</span><br><span class="line">                        .append(records[<span class="number">0</span>])</span><br><span class="line">                        .append(<span class="string">","</span>)</span><br><span class="line">                        .append(entry.getValue())</span><br><span class="line">                        .append(<span class="string">","</span>)</span><br><span class="line">                        .append(filescount.get(records[<span class="number">0</span>]))</span><br><span class="line">                        .append(<span class="string">")"</span>);</span><br><span class="line">                indexes.put(word, indexes.get(word) + sb.toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;String, String&gt; entry : indexes.entrySet()) &#123;</span><br><span class="line">            context.write(<span class="keyword">new</span> Text(entry.getValue() + <span class="string">"&#125;"</span>), NullWritable.get());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="完整源代码"><a href="#完整源代码" class="headerlink" title="完整源代码"></a>完整源代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.StringTokenizer;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map.Entry;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.NullWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper.Context;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileSplit;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.util.GenericOptionsParser;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InverseIndex</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 第一个mr的map类，获取每个单词在单个文件中出现次数，输入为每个文件行偏移量，输出为&lt;word+filename,1&gt;</span></span><br><span class="line"><span class="comment">     * 或&lt;filename,1&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">statisticsMap</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Text mapKey = <span class="keyword">new</span> Text(<span class="string">"key"</span>);</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span></span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            <span class="comment">//获取文件名</span></span><br><span class="line">            FileSplit fileSplit= (FileSplit)context.getInputSplit();</span><br><span class="line">            String fileName = fileSplit.getPath().getName();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//获取单词在单个文件中出现次数，及文件单词总数</span></span><br><span class="line">            StringTokenizer itr= <span class="keyword">new</span> StringTokenizer(value.toString());</span><br><span class="line">            <span class="keyword">for</span>(; itr.hasMoreTokens(); ) &#123;</span><br><span class="line">                String word =removeNonLetters( itr.nextToken().toLowerCase());</span><br><span class="line">                String fileWord = fileName+<span class="string">"\001"</span>+word;</span><br><span class="line">                <span class="keyword">if</span>(!word.equals(<span class="string">""</span>))&#123;</span><br><span class="line">                    context.write(<span class="keyword">new</span> Text(fileWord), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">                    context.write(<span class="keyword">new</span> Text(fileName), <span class="keyword">new</span> IntWritable(<span class="number">1</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//去掉字符串非字母字符</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">removeNonLetters</span><span class="params">(String original)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">            StringBuffer aBuffer=<span class="keyword">new</span> StringBuffer(original.length());</span><br><span class="line">            <span class="keyword">char</span> aCharacter;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;original.length();i++)&#123;</span><br><span class="line">                aCharacter=original.charAt(i);</span><br><span class="line">                <span class="keyword">if</span>(Character.isLetter(aCharacter))&#123;</span><br><span class="line">                    aBuffer.append(aCharacter);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(aBuffer);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//第一个mr的reduce类，统计汇总出现单词的文件个数，及每个文件中单词出现个数及每个文件单词个数,</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">statisticsReduce</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Context context)</span></span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (IntWritable val : values) &#123;</span><br><span class="line">                sum += val.get();</span><br><span class="line">            &#125;</span><br><span class="line">            context.write(key,<span class="keyword">new</span> IntWritable(sum));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">InverseMapper</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>&gt; </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Context context)</span></span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            String valStr = value.toString();</span><br><span class="line">            String[] records = valStr.split(<span class="string">"\t"</span>);</span><br><span class="line">            context.write(<span class="keyword">new</span> Text(<span class="string">"index"</span>),<span class="keyword">new</span> Text(records[<span class="number">0</span>]+<span class="string">"\001"</span>+records[<span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span>  <span class="title">InverseReducer</span> <span class="keyword">extends</span></span></span><br><span class="line"><span class="class">            <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">NullWritable</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,Integer&gt; wordinfilescount = <span class="keyword">new</span> HashMap&lt;String,Integer&gt;();<span class="comment">//key为单词+文件名，value为单词在该文件中出现的次数</span></span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,Integer&gt; filescount = <span class="keyword">new</span> HashMap&lt;String,Integer&gt;();<span class="comment">//key为文件名，value为文件的单词总数</span></span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,Integer&gt; wordinfiles = <span class="keyword">new</span> HashMap&lt;String,Integer&gt;();<span class="comment">//key为单词，value为单词在多少的文件中出现</span></span><br><span class="line">        <span class="keyword">private</span> Map&lt;String,String&gt; indexes = <span class="keyword">new</span> HashMap&lt;String,String&gt;();<span class="comment">//key为单词，value为倒排索引</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">( Text  key, Iterable&lt;Text&gt;  values, Context context)</span></span></span><br><span class="line"><span class="function">                <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            <span class="comment">//拆分输入，获取单词出现在几个文件中以及在该文件中出现次数，各个文件的单词总数，总文件数</span></span><br><span class="line">            <span class="keyword">for</span> (Text val : values) &#123;</span><br><span class="line">                String valStr = val.toString();</span><br><span class="line">                String[] records = valStr.split(<span class="string">"\001"</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">switch</span>(records.length)&#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>:filescount.put(records[<span class="number">0</span>], Integer.parseInt(records[<span class="number">1</span>]));</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">                        wordinfilescount.put(valStr,  Integer.parseInt(records[<span class="number">2</span>]));</span><br><span class="line">                        <span class="keyword">if</span>(!wordinfiles.containsKey(records[<span class="number">1</span>]))&#123;</span><br><span class="line">                            wordinfiles.put(records[<span class="number">1</span>], <span class="number">1</span>);</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            wordinfiles.put(records[<span class="number">1</span>], wordinfiles.get(records[<span class="number">1</span>])+<span class="number">1</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//处理获取倒排索引</span></span><br><span class="line">            <span class="keyword">for</span> (Entry&lt;String, Integer&gt; entry : wordinfilescount.entrySet()) &#123;</span><br><span class="line">                String valStr = entry.getKey();</span><br><span class="line">                String[] records = valStr.split(<span class="string">"\001"</span>);</span><br><span class="line">                String word = records[<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span>(!indexes.containsKey(word))&#123;</span><br><span class="line">                    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                    sb.append(word)</span><br><span class="line">                            .append(<span class="string">"-&gt;"</span>)</span><br><span class="line">                            .append(wordinfiles.get(word))</span><br><span class="line">                            .append(<span class="string">":"</span>)</span><br><span class="line">                            .append(<span class="string">"&#123;("</span>)</span><br><span class="line">                            .append( records[<span class="number">0</span>])</span><br><span class="line">                            .append(<span class="string">","</span>)</span><br><span class="line">                            .append(entry.getValue())</span><br><span class="line">                            .append(<span class="string">","</span>)</span><br><span class="line">                            .append(filescount.get( records[<span class="number">0</span>]))</span><br><span class="line">                            .append(<span class="string">")"</span>);</span><br><span class="line">                    indexes.put(word,sb.toString() );</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                    sb.append(<span class="string">",("</span>)</span><br><span class="line">                            .append( records[<span class="number">0</span>])</span><br><span class="line">                            .append(<span class="string">","</span>)</span><br><span class="line">                            .append(entry.getValue())</span><br><span class="line">                            .append(<span class="string">","</span>)</span><br><span class="line">                            .append(filescount.get( records[<span class="number">0</span>]))</span><br><span class="line">                            .append(<span class="string">")"</span>);</span><br><span class="line">                    indexes.put(word,indexes.get(word)+sb.toString() );</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (Entry&lt;String, String&gt; entry : indexes.entrySet()) &#123;</span><br><span class="line">                context.write(<span class="keyword">new</span> Text(entry.getValue()+<span class="string">"&#125;"</span>), NullWritable.get());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//统计单词在文件中出现次数及单个文件单词总数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">StatisticsTask</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        String[] otherArgs = <span class="keyword">new</span> GenericOptionsParser(conf, args)</span><br><span class="line">                .getRemainingArgs();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            System.err.println(<span class="string">"Usage: ipstatistics &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;"</span>);</span><br><span class="line">            System.exit(<span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Job job = <span class="keyword">new</span> Job(conf, <span class="string">"ipstatistics1"</span>);</span><br><span class="line">        job.setMapperClass(statisticsMap<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        job.setReducerClass(statisticsReduce<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        job.setOutputKeyClass(Text<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        job.setOutputValueClass(IntWritable<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(</span><br><span class="line">                otherArgs[<span class="number">1</span>]));</span><br><span class="line">        job.waitForCompletion(<span class="keyword">true</span>) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//根据统计结果输出倒排索引</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span>  <span class="title">InverseTask</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        String[] otherArgs = <span class="keyword">new</span> GenericOptionsParser(conf, args)</span><br><span class="line">                .getRemainingArgs();</span><br><span class="line">        <span class="keyword">if</span> (otherArgs.length &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            System.err.println(<span class="string">"Usage: ipstatistics &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;"</span>);</span><br><span class="line">            System.exit(<span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Job job = <span class="keyword">new</span> Job(conf, <span class="string">"ipstatistics2"</span>);</span><br><span class="line">        job.setMapperClass( InverseMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        job.setReducerClass( InverseReducer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        job.setOutputKeyClass(Text<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        job.setOutputValueClass(Text<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[<span class="number">1</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(</span><br><span class="line">                otherArgs[<span class="number">2</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        StatisticsTask(args);</span><br><span class="line">        InverseTask(args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="部署运行"><a href="#部署运行" class="headerlink" title="部署运行"></a>部署运行</h2><ul>
<li>启动Hadoop集群</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@gbh:/usr/local/big_data/homework/MapReduce/InvertedIndex<span class="comment"># start-all.sh</span></span><br></pre></td></tr></table></figure>

<ul>
<li>编译源码<br>切换工作目录并编译</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@gbh:/usr/local/big_data/homework/MapReduce/InvertedIndex<span class="comment"># javac -d bin/ src/InverseIndex.java</span></span><br></pre></td></tr></table></figure>
<p>报了一个错误：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">src/InverseIndex.java:<span class="number">8</span>: error: package org.apache.hadoop.conf does not exist</span><br><span class="line">import org.apache.hadoop.conf.Configuration;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>这个错误是因为CLASSPATH环境变量没配置对，在~/.bashrc的末尾添加如下语句：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br><span class="line"><span class="comment">#在末尾添加如下一句</span></span><br><span class="line">eexport CLASSPATH=<span class="variable">$</span>(<span class="variable">$HADOOP_HOME</span>/bin/hadoop classpath):<span class="variable">$CLASSPATH</span></span><br></pre></td></tr></table></figure>
<p>保存退出，通过下面的命令使修改生效</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>重新编译</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@gbh:/usr/local/big_data/homework/MapReduce/InvertedIndex<span class="comment"># javac -d bin/ src/InverseIndex.java</span></span><br></pre></td></tr></table></figure>
<p>可以看到bin目录下生成了编译后的文件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@gbh:/usr/local/big_data/homework/MapReduce/InvertedIndex<span class="comment"># ls bin/ -lh</span></span><br><span class="line">total <span class="number">24</span>K</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>-- <span class="number">1</span> root root <span class="number">2.3</span>K <span class="number">12</span>月 <span class="number">25</span> <span class="number">20</span>:<span class="number">02</span>  InverseIndex<span class="class">.<span class="keyword">class</span></span></span><br><span class="line"><span class="class">-<span class="title">rw</span>-<span class="title">r</span>--<span class="title">r</span>-- 1 <span class="title">root</span> <span class="title">root</span> 1.9<span class="title">K</span> 12月 25 20:02 '<span class="title">InverseIndex</span>$<span class="title">InverseMapper</span>.<span class="title">class</span>'</span></span><br><span class="line"><span class="class">-<span class="title">rw</span>-<span class="title">r</span>--<span class="title">r</span>-- 1 <span class="title">root</span> <span class="title">root</span> 4.1<span class="title">K</span> 12月 25 20:02 '<span class="title">InverseIndex</span>$<span class="title">InverseReducer</span>.<span class="title">class</span>'</span></span><br><span class="line"><span class="class">-<span class="title">rw</span>-<span class="title">r</span>--<span class="title">r</span>-- 1 <span class="title">root</span> <span class="title">root</span> 2.9<span class="title">K</span> 12月 25 20:02 '<span class="title">InverseIndex</span>$<span class="title">statisticsMap</span>.<span class="title">class</span>'</span></span><br><span class="line"><span class="class">-<span class="title">rw</span>-<span class="title">r</span>--<span class="title">r</span>-- 1 <span class="title">root</span> <span class="title">root</span> 1.7<span class="title">K</span> 12月 25 20:02 '<span class="title">InverseIndex</span>$<span class="title">statisticsReduce</span>.<span class="title">class</span>'</span></span><br></pre></td></tr></table></figure>

<ul>
<li>打包jar文件</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">jar <span class="literal">-cvf</span> InverseIndex.jar <span class="literal">-C</span> bin/ .</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">added manifest</span><br><span class="line">adding: InverseIndex<span class="variable">$InverseReducer</span><span class="class">.<span class="keyword">class</span>(<span class="title">in</span> = 4186) (<span class="title">out</span>= 1820)(<span class="title">deflated</span> 56%)</span></span><br><span class="line"><span class="class"><span class="title">adding</span>: <span class="title">InverseIndex</span>.<span class="title">class</span>(<span class="title">in</span> = 2282) (<span class="title">out</span>= 1160)(<span class="title">deflated</span> 49%)</span></span><br><span class="line"><span class="class"><span class="title">adding</span>: <span class="title">InverseIndex</span>$<span class="title">InverseMapper</span>.<span class="title">class</span>(<span class="title">in</span> = 1909) (<span class="title">out</span>= 771)(<span class="title">deflated</span> 59%)</span></span><br><span class="line"><span class="class"><span class="title">adding</span>: <span class="title">InverseIndex</span>$<span class="title">statisticsMap</span>.<span class="title">class</span>(<span class="title">in</span> = 2960) (<span class="title">out</span>= 1371)(<span class="title">deflated</span> 53%)</span></span><br><span class="line"><span class="class"><span class="title">adding</span>: <span class="title">InverseIndex</span>$<span class="title">statisticsReduce</span>.<span class="title">class</span>(<span class="title">in</span> = 1672) (<span class="title">out</span>= 714)(<span class="title">deflated</span> 57%)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>上传输入文件<br>在HDFS中创建input目录，用于存储输入文件</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs <span class="literal">-mkdir</span> input</span><br></pre></td></tr></table></figure>
<p>将输入文件从本地拷贝到HDFS的input目录</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs <span class="literal">-put</span> /usr/local/big_data/homework/<span class="keyword">data</span>/<span class="number">0</span>ws*.txt input</span><br></pre></td></tr></table></figure>
<p>查看是否拷贝成功</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">root@gbh:/usr/local/big_data/homework/MapReduce/InvertedIndex<span class="comment"># hadoop fs -ls input/</span></span><br><span class="line">WARNING: An illegal reflective access operation has occurred</span><br><span class="line">WARNING: Illegal reflective access by org.apache.hadoop.security.authentication.util.KerberosUtil (file:/usr/local/hadoop/share/hadoop/common/lib/hadoop<span class="literal">-auth</span><span class="literal">-2</span>.<span class="number">7.4</span>.jar) to method sun.security.krb5.Config.getInstance()</span><br><span class="line">WARNING: Please consider reporting this to the maintainers of org.apache.hadoop.security.authentication.util.KerberosUtil</span><br><span class="line">WARNING: Use -<span class="literal">-illegal</span><span class="literal">-access</span>=warn to enable warnings of further illegal reflective access operations</span><br><span class="line">WARNING: All illegal access operations will be denied <span class="keyword">in</span> a future release</span><br><span class="line">Found <span class="number">35</span> items</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">146884</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws0110.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">166807</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws0210.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">161786</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws0310.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">189377</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws0410.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">101367</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws0610.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">136652</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws0910.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">138374</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1010.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">117959</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1110.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">143801</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1210.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">137832</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1410.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">145078</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1510.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">156279</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1610.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">112280</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1710.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">137320</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1810.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">159175</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws1910.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">142894</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws2010.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">169826</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws2110.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">139007</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws2210.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">170479</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws2310.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">132199</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws2410.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">140595</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws2510.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">184147</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws2610.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">130617</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws2810.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">150544</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3010.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">143937</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3110.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">172030</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3210.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">158008</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3310.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">119985</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3410.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">165919</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3510.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">181370</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3610.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">126492</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3710.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">177241</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws3910.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">161652</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws4010.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">115675</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws4110.txt</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup     <span class="number">160868</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">13</span>:<span class="number">45</span> input/<span class="number">0</span>ws4210.txt</span><br></pre></td></tr></table></figure>
<p>可以看到输入文件已经拷贝成功。其中的警告信息是因为java版本太高，并不影响hadoop的正常使用，可以忽略。</p>
<ul>
<li>运行Jar文件</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar InverseIndex.jar InverseIndex input tmp output</span><br></pre></td></tr></table></figure>
<p>其中， input 是存储输入文件的目录； tmp 存储的是第一个 map/reduce的输出，也是第二个 map/reduce 的输入； output 存储的第二个map/reduce 的输出，也就是最终结果。<br><strong>Note：tmp和output目录不能事先创建好，如果事先创建好，会报类似下面的错误</strong></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">root@gbh:/usr/local/big_data/homework/MapReduce/InvertedIndex<span class="comment"># hadoop jar InvertedIndex.jar InvertedIndex input invertedindex/output</span></span><br><span class="line">WARNING: An illegal reflective access operation has occurred</span><br><span class="line">WARNING: Illegal reflective access by org.apache.hadoop.security.authentication.util.KerberosUtil (file:/usr/local/hadoop/share/hadoop/common/lib/hadoop<span class="literal">-auth</span><span class="literal">-2</span>.<span class="number">7.4</span>.jar) to method sun.security.krb5.Config.getInstance()</span><br><span class="line">WARNING: Please consider reporting this to the maintainers of org.apache.hadoop.security.authentication.util.KerberosUtil</span><br><span class="line">WARNING: Use -<span class="literal">-illegal</span><span class="literal">-access</span>=warn to enable warnings of further illegal reflective access operations</span><br><span class="line">WARNING: All illegal access operations will be denied <span class="keyword">in</span> a future release</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">25</span> <span class="number">14</span>:<span class="number">21</span>:<span class="number">37</span> INFO Configuration.deprecation: session.id is deprecated. Instead, use dfs.metrics.session<span class="literal">-id</span></span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">25</span> <span class="number">14</span>:<span class="number">21</span>:<span class="number">37</span> INFO jvm.JvmMetrics: Initializing JVM Metrics with processName=JobTracker, sessionId=</span><br><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory hdfs://localhost:<span class="number">9000</span>/user/root/invertedindex/output already exists</span><br><span class="line">	at org.apache.hadoop.mapreduce.lib.output.FileOutputFormat.checkOutputSpecs(FileOutputFormat.java:<span class="number">146</span>)</span><br><span class="line">	at org.apache.hadoop.mapreduce.JobSubmitter.checkSpecs(JobSubmitter.java:<span class="number">266</span>)</span><br><span class="line">	at org.apache.hadoop.mapreduce.JobSubmitter.submitJobInternal(JobSubmitter.java:<span class="number">139</span>)</span><br><span class="line">	at org.apache.hadoop.mapreduce.Job<span class="variable">$10</span>.run(Job.java:<span class="number">1290</span>)</span><br><span class="line">	at org.apache.hadoop.mapreduce.Job<span class="variable">$10</span>.run(Job.java:<span class="number">1287</span>)</span><br><span class="line">	at java.base/java.security.AccessController.doPrivileged(AccessController.java:<span class="number">691</span>)</span><br><span class="line">	at java.base/javax.security.auth.Subject.doAs(Subject.java:<span class="number">423</span>)</span><br><span class="line">	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:<span class="number">1746</span>)</span><br><span class="line">	at org.apache.hadoop.mapreduce.Job.submit(Job.java:<span class="number">1287</span>)</span><br><span class="line">	at org.apache.hadoop.mapreduce.Job.waitForCompletion(Job.java:<span class="number">1308</span>)</span><br><span class="line">	at InvertedIndex.main(InvertedIndex.java:<span class="number">120</span>)</span><br><span class="line">	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:<span class="number">62</span>)</span><br><span class="line">	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class="number">43</span>)</span><br><span class="line">	at java.base/java.lang.reflect.Method.invoke(Method.java:<span class="number">567</span>)</span><br><span class="line">	at org.apache.hadoop.util.RunJar.run(RunJar.java:<span class="number">221</span>)</span><br><span class="line">	at org.apache.hadoop.util.RunJar.main(RunJar.java:<span class="number">136</span>)</span><br></pre></td></tr></table></figure>
<p>存储输出文件的目录，系统会自己创建。</p>
<ul>
<li>查看输出结果<br>查看HDFS上output目录内容</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@gbh:/usr/local/big_data/homework/MapReduce/InvertedIndex<span class="comment"># hadoop fs -ls output/</span></span><br><span class="line">WARNING: An illegal reflective access operation has occurred</span><br><span class="line">WARNING: Illegal reflective access by org.apache.hadoop.security.authentication.util.KerberosUtil (file:/usr/local/hadoop/share/hadoop/common/lib/hadoop<span class="literal">-auth</span><span class="literal">-2</span>.<span class="number">7.4</span>.jar) to method sun.security.krb5.Config.getInstance()</span><br><span class="line">WARNING: Please consider reporting this to the maintainers of org.apache.hadoop.security.authentication.util.KerberosUtil</span><br><span class="line">WARNING: Use -<span class="literal">-illegal</span><span class="literal">-access</span>=warn to enable warnings of further illegal reflective access operations</span><br><span class="line">WARNING: All illegal access operations will be denied <span class="keyword">in</span> a future release</span><br><span class="line">Found <span class="number">2</span> items</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup          <span class="number">0</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">16</span>:<span class="number">38</span> output/_SUCCESS</span><br><span class="line"><span class="literal">-rw</span><span class="literal">-r</span>-<span class="literal">-r</span>--   <span class="number">1</span> root supergroup    <span class="number">3821132</span> <span class="number">2019</span><span class="literal">-12</span><span class="literal">-25</span> <span class="number">16</span>:<span class="number">38</span> output/part<span class="literal">-r</span><span class="literal">-00000</span></span><br></pre></td></tr></table></figure>
<p>output目录下的part-r-00000文件就是存储的最终输出结果。</p>
<ul>
<li>查看结果输出文件内容</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs <span class="literal">-cat</span> output/part<span class="literal">-r</span><span class="literal">-00000</span></span><br></pre></td></tr></table></figure>
<p>可以看到输出如下内容（截取部分）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">broach-&gt;<span class="number">4</span>:&#123;(<span class="number">0</span>ws0110.txt,<span class="number">1</span>,<span class="number">24700</span>),(<span class="number">0</span>ws3710.txt,<span class="number">1</span>,<span class="number">21558</span>),(<span class="number">0</span>ws4210.txt,<span class="number">1</span>,<span class="number">27895</span>),(<span class="number">0</span>ws0910.txt,<span class="number">1</span>,<span class="number">23692</span>)&#125;</span><br><span class="line">throgh-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws1010.txt,<span class="number">1</span>,<span class="number">24377</span>)&#125;</span><br><span class="line">lustier-&gt;<span class="number">3</span>:&#123;(<span class="number">0</span>ws1910.txt,<span class="number">1</span>,<span class="number">27807</span>),(<span class="number">0</span>ws1610.txt,<span class="number">1</span>,<span class="number">27734</span>),(<span class="number">0</span>ws3010.txt,<span class="number">1</span>,<span class="number">26502</span>)&#125;</span><br><span class="line">instances-&gt;<span class="number">6</span>:&#123;(<span class="number">0</span>ws2510.txt,<span class="number">1</span>,<span class="number">25060</span>),(<span class="number">0</span>ws1110.txt,<span class="number">1</span>,<span class="number">20592</span>),(<span class="number">0</span>ws2210.txt,<span class="number">1</span>,<span class="number">24615</span>),(<span class="number">0</span>ws2410.txt,<span class="number">1</span>,<span class="number">22949</span>),(<span class="number">0</span>ws2110.txt,<span class="number">1</span>,<span class="number">29220</span>),(<span class="number">0</span>ws2610.txt,<span class="number">1</span>,<span class="number">32135</span>)&#125;</span><br><span class="line">stout-&gt;<span class="number">12</span>:&#123;(<span class="number">0</span>ws0310.txt,<span class="number">2</span>,<span class="number">27573</span>),(<span class="number">0</span>ws0410.txt,<span class="number">1</span>,<span class="number">32588</span>),(<span class="number">0</span>ws3610.txt,<span class="number">1</span>,<span class="number">31061</span>),(<span class="number">0</span>ws1610.txt,<span class="number">2</span>,<span class="number">27734</span>),(<span class="number">0</span>ws4210.txt,<span class="number">1</span>,<span class="number">27895</span>),(<span class="number">0</span>ws3710.txt,<span class="number">1</span>,<span class="number">21558</span>),(<span class="number">0</span>ws3410.txt,<span class="number">1</span>,<span class="number">20206</span>),(<span class="number">0</span>ws0210.txt,<span class="number">2</span>,<span class="number">28689</span>),(<span class="number">0</span>ws2810.txt,<span class="number">1</span>,<span class="number">23284</span>),(<span class="number">0</span>ws0110.txt,<span class="number">3</span>,<span class="number">24700</span>),(<span class="number">0</span>ws1410.txt,<span class="number">1</span>,<span class="number">23904</span>),(<span class="number">0</span>ws1910.txt,<span class="number">1</span>,<span class="number">27807</span>)&#125;</span><br><span class="line">iuliet-&gt;<span class="number">2</span>:&#123;(<span class="number">0</span>ws3110.txt,<span class="number">8</span>,<span class="number">25123</span>),(<span class="number">0</span>ws1610.txt,<span class="number">54</span>,<span class="number">27734</span>)&#125;</span><br><span class="line">flee-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws1210.txt,<span class="number">1</span>,<span class="number">24901</span>)&#125;</span><br><span class="line">fled-&gt;<span class="number">26</span>:&#123;(<span class="number">0</span>ws2010.txt,<span class="number">1</span>,<span class="number">24815</span>),(<span class="number">0</span>ws2210.txt,<span class="number">5</span>,<span class="number">24615</span>),(<span class="number">0</span>ws0410.txt,<span class="number">4</span>,<span class="number">32588</span>),(<span class="number">0</span>ws1410.txt,<span class="number">1</span>,<span class="number">23904</span>),(<span class="number">0</span>ws3710.txt,<span class="number">1</span>,<span class="number">21558</span>),(<span class="number">0</span>ws0610.txt,<span class="number">2</span>,<span class="number">17919</span>),(<span class="number">0</span>ws3910.txt,<span class="number">5</span>,<span class="number">30687</span>),(<span class="number">0</span>ws3010.txt,<span class="number">1</span>,<span class="number">26502</span>),(<span class="number">0</span>ws0910.txt,<span class="number">1</span>,<span class="number">23692</span>),(<span class="number">0</span>ws3510.txt,<span class="number">3</span>,<span class="number">28227</span>),(<span class="number">0</span>ws1910.txt,<span class="number">1</span>,<span class="number">27807</span>),(<span class="number">0</span>ws1710.txt,<span class="number">3</span>,<span class="number">19538</span>),(<span class="number">0</span>ws0210.txt,<span class="number">6</span>,<span class="number">28689</span>),(<span class="number">0</span>ws3310.txt,<span class="number">3</span>,<span class="number">27164</span>),(<span class="number">0</span>ws2110.txt,<span class="number">3</span>,<span class="number">29220</span>),(<span class="number">0</span>ws1510.txt,<span class="number">7</span>,<span class="number">24965</span>),(<span class="number">0</span>ws3610.txt,<span class="number">1</span>,<span class="number">31061</span>),(<span class="number">0</span>ws3210.txt,<span class="number">2</span>,<span class="number">29959</span>),(<span class="number">0</span>ws1110.txt,<span class="number">3</span>,<span class="number">20592</span>),(<span class="number">0</span>ws4010.txt,<span class="number">3</span>,<span class="number">28122</span>),(<span class="number">0</span>ws3410.txt,<span class="number">7</span>,<span class="number">20206</span>),(<span class="number">0</span>ws0110.txt,<span class="number">8</span>,<span class="number">24700</span>),(<span class="number">0</span>ws1610.txt,<span class="number">2</span>,<span class="number">27734</span>),(<span class="number">0</span>ws0310.txt,<span class="number">8</span>,<span class="number">27573</span>),(<span class="number">0</span>ws1810.txt,<span class="number">1</span>,<span class="number">24517</span>),(<span class="number">0</span>ws2410.txt,<span class="number">3</span>,<span class="number">22949</span>)&#125;</span><br><span class="line">hedgd-&gt;<span class="number">2</span>:&#123;(<span class="number">0</span>ws1810.txt,<span class="number">1</span>,<span class="number">24517</span>),(<span class="number">0</span>ws1410.txt,<span class="number">1</span>,<span class="number">23904</span>)&#125;</span><br><span class="line">hedge-&gt;<span class="number">10</span>:&#123;(<span class="number">0</span>ws1910.txt,<span class="number">1</span>,<span class="number">27807</span>),(<span class="number">0</span>ws3010.txt,<span class="number">1</span>,<span class="number">26502</span>),(<span class="number">0</span>ws2410.txt,<span class="number">1</span>,<span class="number">22949</span>),(<span class="number">0</span>ws1010.txt,<span class="number">1</span>,<span class="number">24377</span>),(<span class="number">0</span>ws0210.txt,<span class="number">1</span>,<span class="number">28689</span>),(<span class="number">0</span>ws2210.txt,<span class="number">1</span>,<span class="number">24615</span>),(<span class="number">0</span>ws3510.txt,<span class="number">1</span>,<span class="number">28227</span>),(<span class="number">0</span>ws2010.txt,<span class="number">1</span>,<span class="number">24815</span>),(<span class="number">0</span>ws2610.txt,<span class="number">1</span>,<span class="number">32135</span>),(<span class="number">0</span>ws4010.txt,<span class="number">2</span>,<span class="number">28122</span>)&#125;</span><br><span class="line">flea-&gt;<span class="number">5</span>:&#123;(<span class="number">0</span>ws1210.txt,<span class="number">1</span>,<span class="number">24901</span>),(<span class="number">0</span>ws1010.txt,<span class="number">1</span>,<span class="number">24377</span>),(<span class="number">0</span>ws2310.txt,<span class="number">2</span>,<span class="number">29377</span>),(<span class="number">0</span>ws3310.txt,<span class="number">1</span>,<span class="number">27164</span>),(<span class="number">0</span>ws2810.txt,<span class="number">1</span>,<span class="number">23284</span>)&#125;</span><br><span class="line">taxing-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws2510.txt,<span class="number">1</span>,<span class="number">25060</span>)&#125;</span><br><span class="line">responsiue-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws2610.txt,<span class="number">1</span>,<span class="number">32135</span>)&#125;</span><br><span class="line">flew-&gt;<span class="number">4</span>:&#123;(<span class="number">0</span>ws0210.txt,<span class="number">1</span>,<span class="number">28689</span>),(<span class="number">0</span>ws3310.txt,<span class="number">1</span>,<span class="number">27164</span>),(<span class="number">0</span>ws4210.txt,<span class="number">1</span>,<span class="number">27895</span>),(<span class="number">0</span>ws1810.txt,<span class="number">1</span>,<span class="number">24517</span>)&#125;</span><br><span class="line">treuant-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws1210.txt,<span class="number">1</span>,<span class="number">24901</span>)&#125;</span><br><span class="line">commandment-&gt;<span class="number">5</span>:&#123;(<span class="number">0</span>ws2610.txt,<span class="number">4</span>,<span class="number">32135</span>),(<span class="number">0</span>ws4010.txt,<span class="number">1</span>,<span class="number">28122</span>),(<span class="number">0</span>ws3610.txt,<span class="number">1</span>,<span class="number">31061</span>),(<span class="number">0</span>ws2110.txt,<span class="number">1</span>,<span class="number">29220</span>),(<span class="number">0</span>ws2510.txt,<span class="number">1</span>,<span class="number">25060</span>)&#125;</span><br><span class="line">sailemaker-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws1010.txt,<span class="number">1</span>,<span class="number">24377</span>)&#125;</span><br><span class="line">carried-&gt;<span class="number">16</span>:&#123;(<span class="number">0</span>ws3910.txt,<span class="number">1</span>,<span class="number">30687</span>),(<span class="number">0</span>ws2610.txt,<span class="number">1</span>,<span class="number">32135</span>),(<span class="number">0</span>ws1710.txt,<span class="number">1</span>,<span class="number">19538</span>),(<span class="number">0</span>ws3510.txt,<span class="number">1</span>,<span class="number">28227</span>),(<span class="number">0</span>ws2010.txt,<span class="number">1</span>,<span class="number">24815</span>),(<span class="number">0</span>ws2210.txt,<span class="number">1</span>,<span class="number">24615</span>),(<span class="number">0</span>ws0610.txt,<span class="number">2</span>,<span class="number">17919</span>),(<span class="number">0</span>ws3310.txt,<span class="number">1</span>,<span class="number">27164</span>),(<span class="number">0</span>ws1110.txt,<span class="number">1</span>,<span class="number">20592</span>),(<span class="number">0</span>ws3110.txt,<span class="number">4</span>,<span class="number">25123</span>),(<span class="number">0</span>ws4210.txt,<span class="number">2</span>,<span class="number">27895</span>),(<span class="number">0</span>ws3610.txt,<span class="number">2</span>,<span class="number">31061</span>),(<span class="number">0</span>ws1210.txt,<span class="number">1</span>,<span class="number">24901</span>),(<span class="number">0</span>ws3410.txt,<span class="number">1</span>,<span class="number">20206</span>),(<span class="number">0</span>ws3010.txt,<span class="number">2</span>,<span class="number">26502</span>),(<span class="number">0</span>ws2310.txt,<span class="number">1</span>,<span class="number">29377</span>)&#125;</span><br><span class="line">auoiding-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws0310.txt,<span class="number">1</span>,<span class="number">27573</span>)&#125;</span><br><span class="line">inthrald-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws0110.txt,<span class="number">1</span>,<span class="number">24700</span>)&#125;</span><br><span class="line">clearenesse-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws3410.txt,<span class="number">1</span>,<span class="number">20206</span>)&#125;</span><br><span class="line">blithe-&gt;<span class="number">2</span>:&#123;(<span class="number">0</span>ws2210.txt,<span class="number">1</span>,<span class="number">24615</span>),(<span class="number">0</span>ws0910.txt,<span class="number">1</span>,<span class="number">23692</span>)&#125;</span><br><span class="line">clothes-&gt;<span class="number">8</span>:&#123;(<span class="number">0</span>ws2310.txt,<span class="number">1</span>,<span class="number">29377</span>),(<span class="number">0</span>ws1010.txt,<span class="number">1</span>,<span class="number">24377</span>),(<span class="number">0</span>ws0110.txt,<span class="number">1</span>,<span class="number">24700</span>),(<span class="number">0</span>ws1610.txt,<span class="number">1</span>,<span class="number">27734</span>),(<span class="number">0</span>ws1910.txt,<span class="number">1</span>,<span class="number">27807</span>),(<span class="number">0</span>ws2610.txt,<span class="number">1</span>,<span class="number">32135</span>),(<span class="number">0</span>ws3110.txt,<span class="number">1</span>,<span class="number">25123</span>),(<span class="number">0</span>ws4010.txt,<span class="number">1</span>,<span class="number">28122</span>)&#125;</span><br><span class="line">raunge-&gt;<span class="number">2</span>:&#123;(<span class="number">0</span>ws1510.txt,<span class="number">1</span>,<span class="number">24965</span>),(<span class="number">0</span>ws2310.txt,<span class="number">1</span>,<span class="number">29377</span>)&#125;</span><br><span class="line">gonerill-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws3310.txt,<span class="number">18</span>,<span class="number">27164</span>)&#125;</span><br><span class="line">stowd-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws3210.txt,<span class="number">1</span>,<span class="number">29959</span>)&#125;</span><br><span class="line">carrier-&gt;<span class="number">2</span>:&#123;(<span class="number">0</span>ws1910.txt,<span class="number">4</span>,<span class="number">27807</span>),(<span class="number">0</span>ws0910.txt,<span class="number">1</span>,<span class="number">23692</span>)&#125;</span><br><span class="line">carries-&gt;<span class="number">15</span>:&#123;(<span class="number">0</span>ws1910.txt,<span class="number">1</span>,<span class="number">27807</span>),(<span class="number">0</span>ws3710.txt,<span class="number">1</span>,<span class="number">21558</span>),(<span class="number">0</span>ws3510.txt,<span class="number">1</span>,<span class="number">28227</span>),(<span class="number">0</span>ws1710.txt,<span class="number">2</span>,<span class="number">19538</span>),(<span class="number">0</span>ws0610.txt,<span class="number">1</span>,<span class="number">17919</span>),(<span class="number">0</span>ws2410.txt,<span class="number">1</span>,<span class="number">22949</span>),(<span class="number">0</span>ws2610.txt,<span class="number">1</span>,<span class="number">32135</span>),(<span class="number">0</span>ws4210.txt,<span class="number">2</span>,<span class="number">27895</span>),(<span class="number">0</span>ws1810.txt,<span class="number">1</span>,<span class="number">24517</span>),(<span class="number">0</span>ws4110.txt,<span class="number">1</span>,<span class="number">19796</span>),(<span class="number">0</span>ws2510.txt,<span class="number">1</span>,<span class="number">25060</span>),(<span class="number">0</span>ws1210.txt,<span class="number">1</span>,<span class="number">24901</span>),(<span class="number">0</span>ws3610.txt,<span class="number">1</span>,<span class="number">31061</span>),(<span class="number">0</span>ws3010.txt,<span class="number">3</span>,<span class="number">26502</span>),(<span class="number">0</span>ws1610.txt,<span class="number">1</span>,<span class="number">27734</span>)&#125;</span><br><span class="line">obiections-&gt;<span class="number">3</span>:&#123;(<span class="number">0</span>ws0210.txt,<span class="number">1</span>,<span class="number">28689</span>),(<span class="number">0</span>ws4210.txt,<span class="number">1</span>,<span class="number">27895</span>),(<span class="number">0</span>ws0110.txt,<span class="number">1</span>,<span class="number">24700</span>)&#125;</span><br><span class="line">vnsuspected-&gt;<span class="number">2</span>:&#123;(<span class="number">0</span>ws0410.txt,<span class="number">1</span>,<span class="number">32588</span>),(<span class="number">0</span>ws1010.txt,<span class="number">1</span>,<span class="number">24377</span>)&#125;</span><br><span class="line">arguments-&gt;<span class="number">7</span>:&#123;(<span class="number">0</span>ws1210.txt,<span class="number">1</span>,<span class="number">24901</span>),(<span class="number">0</span>ws2810.txt,<span class="number">3</span>,<span class="number">23284</span>),(<span class="number">0</span>ws0310.txt,<span class="number">2</span>,<span class="number">27573</span>),(<span class="number">0</span>ws4210.txt,<span class="number">1</span>,<span class="number">27895</span>),(<span class="number">0</span>ws1410.txt,<span class="number">1</span>,<span class="number">23904</span>),(<span class="number">0</span>ws3310.txt,<span class="number">1</span>,<span class="number">27164</span>),(<span class="number">0</span>ws0410.txt,<span class="number">1</span>,<span class="number">32588</span>)&#125;</span><br><span class="line">shreds-&gt;<span class="number">2</span>:&#123;(<span class="number">0</span>ws3610.txt,<span class="number">1</span>,<span class="number">31061</span>),(<span class="number">0</span>ws2610.txt,<span class="number">1</span>,<span class="number">32135</span>)&#125;</span><br><span class="line">raunges-&gt;<span class="number">1</span>:&#123;(<span class="number">0</span>ws3610.txt,<span class="number">1</span>,<span class="number">31061</span>)&#125;</span><br></pre></td></tr></table></figure>


      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/25/Hadoop%E4%B9%8B%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95/" data-id="ck4l9vntf0000csvi1yy5f1m3"
        class="article-share-link">分享</a>
      
    </footer>

  </div>

  
  
  <nav class="article-nav">
    
      <a href="/2019/12/27/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E4%B8%93%E9%A2%98---%E8%AE%A1%E6%95%B0%E5%9E%8B/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            动态规划专题---计数型
          
        </div>
      </a>
    
    
      <a href="/2019/12/24/Ubuntu18-04%E4%B8%8B%E5%AE%89%E8%A3%85Hadoop%E5%8D%95%E6%9C%BA%E4%B8%8E%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E7%8E%AF%E5%A2%83/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">Ubuntu18.04下安装Hadoop单机与伪分布式环境</div>
      </a>
    
  </nav>


  

  
  
<!-- valine评论 -->
<div id="vcomments-box">
    <div id="vcomments">
    </div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#vcomments',
        notify: false,
        verify: false,
        app_id: 'chaSYi8FMdJBwzIBpxeNjqWC-gzGzoHsz',
        app_key: 'PqqkLYgPkHvH1BmyQqySWnSK',
        path: window.location.pathname,
        avatar: 'mp',
        placeholder: '给我的文章加点评论吧~',
        recordIP: true
    });
    const infoEle = document.querySelector('#vcomments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
        infoEle.childNodes.forEach(function (item) {
            item.parentNode.removeChild(item);
        });
    }
</script>
<style>
    #vcomments-box {
        padding: 5px 30px;
    }

    @media screen and (max-width: 800px) {
        #vcomments-box {
            padding: 5px 0px;
        }
    }

    #vcomments-box #vcomments {
        background-color: #fff;
    }

    .v .vlist .vcard .vh {
        padding-right: 20px;
    }

    .v .vlist .vcard {
        padding-left: 10px;
    }
</style>

  

  
  
  

</article>
</section>
      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2015-2020
        Bihui
      </li>
      <li>
        
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a> by shenyu
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <ul class="list-inline">
  <li>PV:<span id="busuanzi_value_page_pv"></span></li>
  <li>UV:<span id="busuanzi_value_site_uv"></span></li>
</ul>
        
      </li>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
    <div class="to_top">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>
      </div>
    </main>
    
    <aside class="sidebar">
      
        <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="面朝大海，春暖花开"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">目录</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/null">摄影</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/null">阅读</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2019/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
      </aside>
      <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i></p>
  <div class="reward-box">
    
    
  </div>
</div>
      
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




  
<script src="/js/tocbot.min.js"></script>

  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>


<script>
  var ayerConfig = {
    mathjax: true
  }
</script>


<script src="/js/ayer.js"></script>


<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">


  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>
  
  
  </div>
</body>

</html>